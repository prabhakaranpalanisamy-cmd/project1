version: 2

semantic_models:
  - name: advisors_sl
    description: "Semantic layer for current advisors model."
    model: ref('PartyAndIdentity', 'advisors')

    defaults:
      agg_time_dimension: as_of_date

    entities:
      - name: advisor
        type: primary
        expr: sfdc_id

    dimensions:
      - name: as_of_date
        type: time
        expr: as_of_date
        type_params:
          time_granularity: day

      - name: state
        type: categorical
        expr: state

      - name: contact_status
        type: categorical
        expr: contact_status

    measures:
      - name: advisor_count
        agg: count_distinct
        expr: sfdc_id
        create_metric: true

      - name: aum_total
        agg: sum
        expr: total_aum
        create_metric: true
